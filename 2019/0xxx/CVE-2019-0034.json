{
   "CVE_data_meta": {
      "ASSIGNER": "sirt@juniper.net",
      "DATE_PUBLIC": "2019-04-10T16:00:00.000Z",
      "ID": "CVE-2019-0034",
      "STATE": "PUBLIC",
      "TITLE": "Junos OS: gRPC hardcoded credentials may allow unauthorized access to systems with Junos Network Agent installed"
   },
   "affects": {
      "vendor": {
         "vendor_data": [
            {
               "product": {
                  "product_data": [
                     {
                        "product_name": "Junos OS",
                        "version": {
                           "version_data": [
                              {
                                 "version_affected": "<",
                                 "version_name": "16.1",
                                 "version_value": "16.1R3-S10, 16.1R7-S4"
                              },
                              {
                                 "version_affected": "<",
                                 "version_name": "17.1",
                                 "version_value": "17.1R2-S10, 17.1R3"
                              },
                              {
                                 "version_affected": "<",
                                 "version_name": "17.2",
                                 "version_value": "17.2R1-S8, 17.2R3-S1"
                              },
                              {
                                 "version_affected": "<",
                                 "version_name": "17.3",
                                 "version_value": "17.3R3-S3"
                              },
                              {
                                 "version_affected": "<",
                                 "version_name": "17.4",
                                 "version_value": "17.4R1-S6, 17.4R2-S3"
                              },
                              {
                                 "version_affected": "<",
                                 "version_name": "18.1",
                                 "version_value": "18.1R2-S4, 18.1R3-S3"
                              },
                              {
                                 "version_affected": "<",
                                 "version_name": "18.2",
                                 "version_value": "18.2R1-S5, 18.2R2-S1"
                              },
                              {
                                 "version_affected": "<",
                                 "version_name": "18.2X75",
                                 "version_value": "18.2X75-D40"
                              },
                              {
                                 "version_affected": "<",
                                 "version_name": "18.3",
                                 "version_value": "18.3R1-S2, 18.3R1-S3"
                              },
                              {
                                 "version_affected": "!<",
                                 "version_name": "all",
                                 "version_value": "16.1"
                              }
                           ]
                        }
                     }
                  ]
               },
               "vendor_name": "Juniper Networks"
            }
         ]
      }
   },
   "configuration": [
      {
         "lang": "eng",
         "value": "Devices with Network Agent installed will match the following software version output:\n\n  user@junos> show version | grep na\\ telemetry\n  JUNOS na telemetry [17.3R3-S3.3] \n\ngRPC is enabled by the following command:\n\n  user@junos# set system services extension-service request-response grpc\n\n"
      }
   ],
   "data_format": "MITRE",
   "data_type": "CVE",
   "data_version": "4.0",
   "description": {
      "description_data": [
         {
            "lang": "eng",
            "value": "Starting with Junos OS Release 16.1R3, the Junos Telemetry Interface supports Google gRPC remote procedure calls to provision sensors and to subscribe to and receive telemetry data.\n\nConfiguration files used by gRPC were found to contain hardcoded credentials that could be used by the Junos Network Agent to perform unauthorized read of certain non-critical information (e.g. sensor data).  Additionally, APIs exposed via the Juniper Extension Toolkit (JET) may be able to perform non-critical 'set' operations on the device. These APIs need the client to be authenticated for which the username/password can be used.\n\nSuccessful exploitation of this vulnerability can only occur if the Junos Network Agent package (Junos Telemetry Interface) is installed on the device.  If the Junos Network \nAgent is not installed, then the gRPC interface required to leverage these credentials is unavailable and the system is not vulnerable to this issue.\n\nAffected releases are Juniper Networks Junos OS:\n16.1 versions prior to 16.1R3-S10, 16.1R7-S4;\n17.1 versions prior to 17.1R2-S10, 17.1R3;\n17.2 versions prior to 17.2R1-S8, 17.2R3-S1;\n17.3 versions prior to 17.3R3-S3;\n17.4 versions prior to 17.4R1-S6, 17.4R2-S3;\n18.1 versions prior to 18.1R2-S4, 18.1R3-S3;\n18.2 versions prior to 18.2R1-S5, 18.2R2-S1;\n18.2X75 versions prior to 18.2X75-D40;\n18.3 versions prior to 18.3R1-S2, 18.3R1-S3.\n\nThis issue does not affect Junos OS releases prior to 16.1."
         }
      ]
   },
   "exploit": [
      {
         "lang": "eng",
         "value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
      }
   ],
   "generator": {
      "engine": "Vulnogram 0.0.6"
   },
   "impact": {
      "cvss": {
         "attackComplexity": "LOW",
         "attackVector": "NETWORK",
         "availabilityImpact": "NONE",
         "baseScore": 6.5,
         "baseSeverity": "MEDIUM",
         "confidentialityImpact": "LOW",
         "integrityImpact": "LOW",
         "privilegesRequired": "NONE",
         "scope": "UNCHANGED",
         "userInteraction": "NONE",
         "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N",
         "version": "3.0"
      }
   },
   "problemtype": {
      "problemtype_data": [
         {
            "description": [
               {
                  "lang": "eng",
                  "value": "CWE-798 Use of Hard-coded Credentials"
               }
            ]
         }
      ]
   },
   "references": {
      "reference_data": [
         {
            "name": "https://kb.juniper.net/JSA10923",
            "refsource": "CONFIRM",
            "url": "https://kb.juniper.net/JSA10923"
         },
         {
            "name": "https://www.juniper.net/documentation/en_US/junos/topics/task/installation/network-agent-installing.html",
            "refsource": "MISC",
            "url": "https://www.juniper.net/documentation/en_US/junos/topics/task/installation/network-agent-installing.html"
         },
         {
            "name": "https://www.juniper.net/documentation/en_US/junos/topics/task/configuration/grpc-junos-telemetry-interface-configuring.html",
            "refsource": "MISC",
            "url": "https://www.juniper.net/documentation/en_US/junos/topics/task/configuration/grpc-junos-telemetry-interface-configuring.html"
         },
         {
            "name": "https://www.juniper.net/documentation/en_US/junos/topics/concept/junos-telemetry-interface-oveview.html",
            "refsource": "MISC",
            "url": "https://www.juniper.net/documentation/en_US/junos/topics/concept/junos-telemetry-interface-oveview.html"
         }
      ]
   },
   "solution": [
      {
         "lang": "eng",
         "value": "The following software releases have been updated to resolve this specific issue: Junos OS 16.1R3-S10, 16.1R7-S4, 17.1R2-S10, 17.1R3, 17.2R1-S8, 17.2R3-S1, 17.3R3-S3, 17.4R1-S6, 17.4R2-S3, 18.1R2-S4, 18.1R3-S3, 18.2R1-S5, 18.2R2-S1, 18.2X75-D40, 18.3R1-S2, 18.4R1, and all subsequent releases.\n"
      }
   ],
   "source": {
      "advisory": "JSA10923",
      "defect": [
         "1394927"
      ],
      "discovery": "INTERNAL"
   },
   "work_around": [
      {
         "lang": "eng",
         "value": "Disable the gRPC service via the following command if it is not needed in your environment:\n\n  delete system services extension-service request-response grpc \n\nIn addition to the recommendation listed above, it is good security practice to limit the exploitable attack surface of critical infrastructure networking equipment. Use access lists or firewall filters to limit access to the device only from trusted, administrative networks or hosts."
      }
   ]
}