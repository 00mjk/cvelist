{
    "CVE_data_meta": {
        "ASSIGNER": "security@php.net",
        "DATE_PUBLIC": "2019-10-22T03:18:00.000Z",
        "ID": "CVE-2019-11043",
        "STATE": "PUBLIC",
        "TITLE": "Underflow in PHP-FPM can lead to RCE"
    },
    "affects": {
        "vendor": {
            "vendor_data": [
                {
                    "product": {
                        "product_data": [
                            {
                                "product_name": "PHP",
                                "version": {
                                    "version_data": [
                                        {
                                            "version_affected": "<",
                                            "version_name": "7.1.x",
                                            "version_value": "7.1.33"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "7.2.x",
                                            "version_value": "7.2.24"
                                        },
                                        {
                                            "version_affected": "<",
                                            "version_name": "7.3.x",
                                            "version_value": "7.3.11"
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    "vendor_name": "PHP"
                }
            ]
        }
    },
    "credit": [
        {
            "lang": "eng",
            "value": "Reported by Emil Lerner. "
        }
    ],
    "data_format": "MITRE",
    "data_type": "CVE",
    "data_version": "4.0",
    "description": {
        "description_data": [
            {
                "lang": "eng",
                "value": "In PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11 in certain configurations of FPM setup it is possible to cause FPM module to write past allocated buffers into the space reserved for FCGI protocol data, thus opening the possibility of remote code execution. "
            }
        ]
    },
    "exploit": [
        {
            "lang": "eng",
            "value": "Exploit described at https://github.com/neex/phuip-fpizdam"
        }
    ],
    "generator": {
        "engine": "Vulnogram 0.0.8"
    },
    "impact": {
        "cvss": {
            "attackComplexity": "HIGH",
            "attackVector": "NETWORK",
            "availabilityImpact": "NONE",
            "baseScore": 8.7,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "CHANGED",
            "userInteraction": "NONE",
            "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N",
            "version": "3.1"
        }
    },
    "problemtype": {
        "problemtype_data": [
            {
                "description": [
                    {
                        "lang": "eng",
                        "value": "CWE-120 Buffer Overflow"
                    }
                ]
            }
        ]
    },
    "references": {
        "reference_data": [
            {
                "refsource": "CONFIRM",
                "url": "https://bugs.php.net/bug.php?id=78599"
            },
            {
                "refsource": "CONFIRM",
                "url": "https://github.com/neex/phuip-fpizdam"
            }
        ]
    },
    "source": {
        "defect": [
            "https://bugs.php.net/bug.php?id=78599"
        ],
        "discovery": "EXTERNAL"
    },
    "work_around": [
        {
            "lang": "eng",
            "value": "Configuring nginx (or other server that implements the front-end part of the FPM protocol) to check for the existence of the target file before passing it to PHP FPM (e.g. \"try_files $uri =404\" or \"if (-f $uri)\" in nginx) for would prevent this vulnerability from happening. "
        }
    ]
}